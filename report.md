# Bagian Teori — UTS Sistem Terdistribusi
Tema: Pub-Sub Log Aggregator dengan Idempotent Consumer dan Deduplication

## T1 (Bab 1) – Karakteristik dan Trade-off Pub-Sub Aggregator
Sistem terdistribusi memiliki tiga ciri utama: concurrency, absence of a global clock, dan independent failures (Tanenbaum & Van Steen, 2021). Dalam konteks Pub-Sub log aggregator, komponen publisher dan subscriber beroperasi secara asinkron di node berbeda tanpa sinkronisasi waktu global, sehingga dibutuhkan mekanisme penanganan duplikasi serta retries. Trade-off utama yang muncul adalah antara consistency dan availability (Coulouris et al., 2012). Model publish–subscribe memilih availability lebih tinggi melalui asynchronous decoupling, namun menurunkan konsistensi karena retries bisa menimbulkan duplikasi. Solusinya ialah menerapkan idempotent consumer dan deduplication agar state akhir tetap stabil (eventual consistency) tanpa mengorbankan throughput. Selain itu, trade-off antara latensi dan reliability dikelola melalui mekanisme retry + backoff dan penyimpanan persisten (WAL) yang menjamin durability meskipun consumer crash.

## T2 (Bab 2) – Client–Server vs Publish–Subscribe
Model client–server menawarkan interaksi sinkron satu-lawan-satu, cocok untuk permintaan deterministik namun tidak efisien pada beban banyak produsen/konsumen. Sebaliknya, publish–subscribe memisahkan komponen berdasarkan topic sehingga produsen tidak perlu mengetahui subscriber (Coulouris et al., 2012, Bab 2). Untuk aggregator, arsitektur Pub-Sub lebih sesuai karena mendukung scalability, temporal decoupling, dan multicast delivery. Pub-Sub juga memungkinkan event driven processing dan asynchronous queuing yang meningkatkan throughput. Client-server lebih tepat untuk skenario query-based atau transactional, sementara Pub-Sub lebih efisien untuk log stream berkecepatan tinggi karena memanfaatkan buffer (queue) serta konsumsi paralel. Tanenbaum & Van Steen (2021) menekankan bahwa Pub-Sub memenuhi prinsip separation of concerns dan memudahkan fault isolation karena publisher tetap berfungsi meski subscriber gagal.

## T3 (Bab 3) – Delivery Semantics dan Idempotent Consumer
Menurut Tanenbaum & Van Steen (2021), tiga semantik pengiriman utama adalah at-most-once, at-least-once, dan exactly-once. Karena jaringan asinkron tidak dapat menjamin exactly-once secara universal, model at-least-once lebih realistis namun berpotensi menghasilkan duplikasi. Di sinilah peran konsumen idempoten krusial: operasi yang diulang tidak mengubah hasil akhir. Implementasi idempoten pada aggregator dicapai dengan pengecekan PRIMARY KEY (topic,event_id) sebelum proses insert. Coulouris et al. (2012) menyebut pendekatan ini sebagai mekanisme kompensasi praktis untuk mencapai efek fault-tolerant communication. Dengan demikian, exactly-once effect dapat disimulasikan meski delivery hanya at-least-once.

## T4 (Bab 4) – Skema Penamaan Topic dan Event_ID
Penamaan adalah elemen fundamental dalam resolusi sumber daya terdistribusi (Coulouris et al., 2012, Bab 4). Setiap event harus memiliki identitas unik dan collision-resistant untuk dedup. Desain yang direkomendasikan adalah menggunakan hash kriptografis (SHA-256) yang menggabungkan topic, source, dan payload sebagai basis event_id. Skema penamaan topic menggunakan konvensi hierarkis (lowercase, separator dot/colon) agar dapat diindeks efisien oleh storage. Dengan struktur ini, deduplication menjadi O(1) karena setiap kombinasi (topic,event_id) mempunyai PRIMARY KEY. Tanenbaum & Van Steen (2021) menekankan bahwa skema penamaan yang stabil meningkatkan transparency dan mapping consistency di sistem terdistribusi terbuka.

## T5 (Bab 5) – Ordering dan Pendekatan Praktis
Ordering dapat berupa total, causal, atau partial (Tanenbaum & Van Steen, 2021). Total ordering memberi urutan global namun mahal secara sinkronisasi. Untuk log aggregator, total ordering tidak diperlukan karena event dapat diproses secara independen per-topic. Pendekatan praktis adalah mengurutkan berdasarkan timestamp ISO 8601 dan monotonic counter pada sumber event. Kelemahannya adalah clock skew antar node yang dapat menyebabkan out-of-order minor, namun tidak mengganggu konsistensi akhir. Coulouris et al. (2012) menjelaskan bahwa pemilihan model ordering merupakan kompromi antara latensi dan akurasi waktu; untuk monitoring atau logging, causal ordering sudah memadai.

## T6 (Bab 6) – Failure Modes dan Strategi Mitigasi
Bab 6 (Tanenbaum & Van Steen, 2021) menguraikan jenis kegagalan: crash, omission, timing, dan byzantine. Pada Pub-Sub aggregator, failure yang paling relevan ialah duplikasi (akibat retries), out-of-order (akibat jitter), dan crash consumer. Strategi mitigasinya meliputi: (1) exponential backoff retry di publisher untuk menghindari congestion; (2) deduplication persisten (SQLite + WAL) agar event yang pernah diproses tidak diulang setelah restart; (3) graceful shutdown dan checkpoint periodik agar state tidak hilang. Menurut Coulouris et al. (2012), mekanisme ini meningkatkan reliability dan fault recovery tanpa memerlukan protokol replikasi kompleks.

## T7 (Bab 7) – Eventual Consistency melalui Idempotency dan Deduplication
Konsistensi lemah seperti eventual consistency memungkinkan replika berbeda sementara tetapi pada akhirnya konvergen jika tidak ada update baru (Tanenbaum & Van Steen, 2021, Bab 7). Aggregator menerima at-least-once delivery yang berpotensi duplikasi; namun idempotency menjamin state akhir sama meski event diproses ulang. Dedup store persisten berfungsi sebagai memori stabil untuk menghindari anomali setelah restart. Menurut Coulouris et al. (2012), kombinasi mekanisme idempoten dan dedup ini adalah bentuk praktis dari convergence guarantee tanpa koordinasi global (konsistensi akhir non-blokir).

## T8 (Bab 1–7) – Metrik Evaluasi dan Kaitannya dengan Desain
Metrik utama evaluasi sistem adalah throughput, latency, dan duplicate rate (Tanenbaum & Van Steen, 2021). Throughput menunjukkan kemampuan proses event per detik, dipengaruhi oleh desain queue dan dedup O(1). Latency tergantung pada I/O SQLite dan asynchronous loop. Duplicate rate menjadi indikator efektivitas idempotency dan backoff. Trade-off antara throughput dan consistency dikelola dengan memilih model eventual consistency agar sistem tetap responsif. Dari Bab 1–7, terlihat bahwa desain Pub-Sub aggregator menggabungkan decentralization (Bab 1-2), reliable messaging (Bab 3-4), ordering relaks (Bab 5), fault-tolerance (Bab 6), dan konsistensi akhir (Bab 7) untuk mencapai kinerja optimal pada lingkungan terdistribusi.

---
### Referensi (APA edisi ke-7)
- Coulouris, G., Dollimore, J., Kindberg, T., & Blair, G. (2012). *Distributed Systems: Concepts and Design* (5th ed.). Pearson.
- Tanenbaum, A. S., & Van Steen, M. (2021). *Distributed Systems: Principles and Paradigms* (4th ed.). Pearson.
